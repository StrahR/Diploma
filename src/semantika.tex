\section{Semantika}

\subsection{Modeli algebrajskih teorij z linearnimi parametri}
% \subsubsection{Algebrajska teorija z linearnimi parametri}

\begin{definition}[Členost]
    Členost, \(\arity{p}{m₁, …, mₖ}\), je naravno število \(p\) skupaj s seznamom naravnih števil \(mᵢ\).
% \end{definition}
% \begin{definition}
    Signatura z linearnimi parametri je množica operacij s členostmi.
    Neformalno to pove, da operacija \(\op O\) sprejme \(p\) parametrov in \(k\) računskih spremenljivk, kjer \(i\)-ta veže \(mᵢ\) parametrov.
    Pišemo \(\op O : \arity{p}{m₁, …, mₖ}\).
\end{definition}

\begin{example}
    Členosti operacij jezika iz prejšnjega razdelka so sledeče:
    \begin{gather*}
        \op{new}          : \arity{0}{1}\qquad
        \op{measure}      : \arity{1}{0, 0}\qquad
        \op{discard}      : \arity{1}{0}\qquad
        \op{apply}_{\g U} : \arity{n}{n}
    \end{gather*}
\end{example}

\begin{definition}
    Aksiom v neki signaturi je par izrazov v istem kontekstu; pišemo \(\absseq{t=u}\).
    Predstavitev teorije je signatura skupaj z množico aksiomov.
\end{definition}

\begin{definition}
    Kategorija je sestavljena iz
    \begin{itemize}
        \item nabora objektov (ponavadi označeni z \(X,Y,Z,…\)) in
        \item nabora morfizmov (ponavadi označeni s \(f,g,h,…\)),
    \end{itemize}
    tako da
    \begin{itemize}
        \item ima vsak morfizem dva objekta, ki jima pravimo domena in kodomena (označimo \(f : X → Y\), kjer je \(X\) domena in \(Y\) kodomena),
        \item ima vsak objekt \(X\) identiteto \(1_X : X → X\),
        \item ima vsak par morfizmov \(f\) in \(g\), tako da je kodomena \(f\) enaka domeni \(g\), kompozitum \(g∘f\), ki ima domeno enako \(f\) in kodomeno enako \(g\),
    \end{itemize}
    in veljata naslednja aksioma:
    \begin{itemize}
        \item za vsak \(f : X → Y\) velja \(1_Y∘f = f = f∘1_X\) in
        \item za vsake \(f,g,h : X → Y → Z → W\) velja \(h∘(g∘f) = (h∘g)∘f\).
    \end{itemize}
\end{definition}

\begin{examples}
    Poznamo mnogo primerov kategorij, nekaj bolj znanih naštejmo spodaj:
    \begin{itemize}
        \item grupe s homomorfizmi,
        \item topološki prostori z zveznimi preslikavami,
        \item Hausdorffovi prostori z zveznimi preslikavami,
        \item vektorski prostori z linearnimi preslikavami,
        \item …
    \end{itemize}
\end{examples}

Intuitivno lahko gledamo na kategorije kot neke splošne strukture, v katerih imajo objekti neko svojo strukturo, ki jo morfizmi spoštujejo.

% So pa kategorije bistveno bolj splošnejši pojem od tega, na primer delno urejene množice lahko predstavimo kot kategorije:
% \begin{example}
%     Naj bo \(\p{P, ≤}\) delno urejena množica.
%     Vzemimo za objekte kategorije elemente množice \(P\), morfizem med objekti \(x\) in \(y\) pa naj obstaja natanko tedaj, ko je \(x ≤ y\).
%     Tokrat morfizmi niso funkcije, vendar zgolj formalni objekti, ampak vseeno zadoščajo vsem pogojem kategorije.
% \end{example}

Omejimo se na kategorije, kjer za vsak objekt \(X\) in vsako naravno število \(n\) obstaja nek objekt \(n•X\). Operacijo \(•\) lahko razumemo kot delovanje naravnih števil na dano kategorijo.
Tedaj lahko morfizme \(X → n•Y\) interpretiramo kot morfizme \(X → Y\) z \(n\) parametri.
Operacije \(\op{O} : \arity{p}{m₁,…,mₖ}\) bomo interpretirali z morfizmi oblike \( \abssemmap{p}{m₁,…,mₖ}\).

\begin{definition}
    Struktura za signaturo je objekt \(X\) skupaj z morfizmom oblike \(\abssemmap{p}{m₁,…,mₖ}\) za vsako operacijo \(\op{O} : \arity{p}{m₁,…,mₖ}\). Označimo ga z \(\sem{\op{O}}\).
\end{definition}

\begin{definition}
    Vsakemu izrazu \(\seq{t}\) definiramo njegov interpretacijski morfizem \(\sem{t}\) z indukcijo na strukturi členov na naslednji način:
    \[ \sem{\op{O}{\p{a₁,…,aₚ; b₁,…,b_{m₁}.t₁, …, b₁,…,b_{mₖ}.tₖ}}}
      = \sem{\op{O}}{\p{\sem{t₁}{\p -},…,\sem{tₖ}{\p -}}},\]
    kjer \(\op{O}\) interpretiramo z morfizmom iz signature, \(tᵢ\) pa po indukciji.
\end{definition}

\begin{definition}
    Model za algebrajsko teorijo z linearnimi parametri je struktura za njeno signaturo, tako da sta za vsak aksiom \(\absseq{t=u}\) interpretacijska morfizma \(\sem{t}\) in \(\sem{u}\) enaka.
\end{definition}

\begin{proposition}[Zdravost]
    Če lahko enakost izpeljemo v algebrajski teoriji, potem drži v vseh modelih.
\end{proposition}

\begin{proof}
    Dokaz poteka po indukciji. Naj bo \(\absseq{t=u}\).
    % Naj bo \(\seq{t=u}\) in naj bosta \(t\) in \(u\) oblike
    % \begin{align*}
    %     t &= \op{O}₁{\p{a₁,…,aₚ ; b₁,…,b_{m₁}.t₁, …, b₁,…,b_{mₖ}.tₖ}}\\
    %     u &= \op{O}₂{\p{a₁,…,a_q; b₁,…,b_{n₁}.u₁, …, b₁,…,b_{nₗ}.uₗ}}.
    % \end{align*}
    Brez škode za splošnost je lahko veriga enakosti prek aksiomov dolga zgolj en člen, saj je enakost tranzitivna.
    Tedaj lahko ta aksiom uporabimo na dva načina: prvi je, da ga uporabimo na podizrazih, kar pomeni, da sta interpretacijska morfizma enaka po indukciji, drugi je pa, da aksiom uporabimo neposredno na celih izrazih, iz česar pa enakost morfizmov sledi neposredno iz definicije modela.
    % Če sta operaciji \(\op{O}₁\) in \(\op{O}₂\) enaki, sta tudi interpretacijska morfizma enaka natanko tedaj, ko lahko izpeljemo enakost med 
\end{proof}

%TODO: define fully complete models?

%TODO: what is this?
\subsection{Semantika kvantnega programskega jezika}

\subsection{\texorpdfstring{\(C^*\)-algebre}{C*-algebre}}

%TODO: citations
\begin{definition} %TODO: cite vidav
    Za polje \(k\) je množica \(A\) \(k\)-algebra, če je
    \begin{enumerate}
        \item \(k\)-vektorski prostor,
        \item kolobar za seštevanje in množenje,
        \item velja \(\for{a,b ∈ A, λ ∈ k}{(λa)b = λ(ab) = a(λb)}\).
    \end{enumerate}
\end{definition}

\begin{definition}
    \(k\)-algebra \(A\) je normirana, če ima normo in za poljubna \(x,y ∈ A\) velja \(\|xy\| ≤ \|x\|\|y\|\).
\end{definition}
\begin{definition} %TODO: cite vidav
    Involucija je operacija \(x ↦ x^*\) na elementih algebre, za katero velja:
    \begin{enumerate}
        \item \(\for{a,b ∈ A}{(a+b)^* = a^* + b^*}\),
        \item \(\for{λ ∈ ℂ, a ∈ A}{(λa)^* = \bar{λ}a^*}\),
        \item \(\for{a,b ∈ A}{(xy)^* = y^*x^*}\),
        \item \(\for{a ∈ A}{a^{**} = a}\).
    \end{enumerate}
\end{definition}
\begin{definition}
    Normirana \(k\)-algebra je Banachova, če je polna kot metrični prostor z metriko porojeno iz norme.
\end{definition}

\begin{definition}
    Množica \(A\) je \(C^*\)-algebra, če:
    \begin{enumerate}[(a)]
        \item je Banachova \(ℂ\)-algebra z enoto,
        \item ima involucijo \((-)^*\),
        \item za vsak \(x ∈ A\) velja \(\|x\|² = \|x^*x\|\).
    \end{enumerate}
\end{definition}
\begin{remark}
    \(C^*\) se prebere kot \airquotes{c zvezdica}.
\end{remark}
\begin{remark}
    V fiziki se iz zgodovinskih razlogov involucija pogosto označuje z \((-)^†\).
\end{remark}
\begin{remark}
    Velja \(\|x^*\| = \|x\|\), saj je \(\|x\|² = \|x^*x\| = \|x^*\|²\) in \(\|x^*x\| ≤ \|x*\|\|x\|\).
\end{remark}

\begin{definition}
    Za \(C^*\)-algebri \(A\) in \(B\) je preslikava \(f : A → B\) \(*\)-homomorfizem, če je linearna in ohranja množenje, enoto, ter involucijo.
\end{definition}
\begin{remark}
    \(*\)-homorfizem se prebere kot \airquotes{zvezdica homomorfizem}.
\end{remark}

\begin{example}
    Množica kompleksnih \(n×n\) matrik \( \M[n] ≔ Mₙ(ℂ) \), kjer za normo vzamemo determinanto in za involucijo hermitsko transponiranje, je \(C^*\)-algebra.
    Res, lastnosti (a) do (c) držijo (to vemo od prej), lastnost (d) je pa preprosto preveriti: \(\det{\p{A^{H}A}} = \p{\det{A^H}}\p{\det{A}} = \p{\det{A}}²\).
\end{example}

\begin{definition}
    %TODO: finish definition
    Direktna vsota \(C^*\)-algeber \(X\) in \(Y\) je kartezični produkt množic z operacijami definiranimi po komponentah.
    Označimo jo z \(X⊕Y\).
\end{definition}

\begin{example}
    %TODO: finish definition
    Za vsako \(C^*\)-algebro \(X\) je tudi množica \(n×n\) matrik nad \(X\) \(C^*\)-algebra.
    Označimo jo z \(Mₙ(X)\).
\end{example}

\begin{proposition}
    Velja \(Mₙ(\M[k]) ≅ \M[nk]\).
\end{proposition}

\begin{proposition}
    \(C^*\)-algebre skupaj z \(*\)-homomorfizmi tvorijo kategorijo \(\cstarcat\).
\end{proposition}

\subsection{Polnost za meritev}
Operacijo s členostjo \(\arity{p}{m₁,…,mₖ}\) želimo interpretirati z morfizmom iz \(\semmap{p}{m₁,…,mₖ}\). Za \(\op{measure}\) in \(\op{apply}\) to ni problem, saj \(*\)-homomorfizmi iz \(\semmap{1}{0,0}\) in \(\semmap{p}{p}\) obstajajo, vendar problem nastane pri \(\op{new}\).
Želeli bi \(*\)-homomorfizem oblike \(\semmap{0}{1}\), vendar ta ne obstaja. Problem rešimo tako, da najprej dokažemo izrek zgolj za meritve in uporabo vrat, kasneje pa razvijemo orodje, s katerim lahko interpretiramo \(\op{new}\), in potem poskusimo izraze z \(\op{new}\) prevesti na ustrezne izraze brez \(\op{new}\).

\begin{definition}
    Meritev interpretiramo z \(*\)-homomorfizmi oblike \(\op{measure}{\p X} : \opmap{1}{0, 0}\) s predpisom \[\smeasure{\p X}{α}{β} = \p{\mat{α & 0 \\ 0 & β}},\].

    Meritev na \(j\)-tem mestu izvajamo z \(\op{measure}ⱼ ≔ Mⱼ{\p{\op{measure}{\p X}}}\).
\end{definition}
\begin{remark}
    Za \(X\) implicitno izberemo tak \(\M[k]\), da bo interpretacija prave dimenzije.
    V praksi bo \(k\) ponavadi kar \(p-j\), kjer je \(p\) število kubitov v sistemu.
\end{remark}

%TODO: fix how I use this (change order of ^*)
\begin{definition}
    Za \(U ∈ \U[p]\) interpretiramo operacijo \(\op{apply}_{\g U}\) z \(*\)-homomorfizmom \( \op{apply}_{\g U} : \semmap{p}{p}\) s predpisom \(A ↦ U^*AU.\)
\end{definition}
\begin{remark}
    Pri interpretaciji uporabe vrat se zanašamo na uporabnika, da vrata \(U\) skonstruira tako, da delujejo na želenih kubitih, tako da ne bomo uvajali posebnega zapisa za delno uporabo vrat.
\end{remark}
%TODO: motivate these interpretations and define models as opposite category if possible

% \begin{definition}
%     Definirajmo še interpretacijo za \(\op{discard}\): \[\op{discard}(α) ≔ \op{measure}(α,α).\]
% \end{definition}

\begin{proposition}
    Kompleksna števila \(ℂ ∈ \cstarcat\) tvorijo model fragmenta kvantnega računalništva, ki vključuje operaciji \(\op{measure}\) in \(\op{apply}\) (ampak ne \(\op{new}\)) in vse relevantne aksiome ((\ref{ax:A}) – (\ref{ax:B}), (\ref{ax:F}) – (\ref{ax:J})).
\end{proposition}

\begin{proof}
    Definirajmo \(n•ℂ ≔ \M[2ⁿ]\) in operaciji \(\op{measure}\) in \(\op{apply}\) interpretirajmo kot zgoraj.
    To je že struktura, sedaj moramo pa še preveriti aksiome.
    \begin{enumerate}[\((A)\)]
        \item \( \sequent{x:0,y:0}{a}{
                    \tapply{X}{a}{\tmeasure{a}{x}{y}} = \tmeasure{a}{y}{x}} \)
        \item \( \sequent{x:1,y:1}{a,b}{
                    \tapplyd{U, V}{a,b}{\tmeasure{a}{x(b)}{y(b)}}\\
                    \text{\hspace{7em}} = \tmeasure{a}{\tapply{U}{b}{x(b)}}{\tapply{V}{b}{y(b)}}} \)
        % \item \( \sequent{Γ}{a}{\tapply{U}{a}{\tdiscard{a}{t}} = \tdiscard{a}{t}} \)
        \addtocounter{enumi}{3}
        \item \( \sequent{x:2}{a,b}{\tapply{swap}{a,b}{x{\p{a,b}}} = x{\p{b,a}}} \)
        \item \( \sequent{x:1}{a}{\tapply{I}{a}{x{\p a}} = x{\p a}} \)
        \item \( \sequent{x:1}{a}{\tapply{UV}{a}{x{\p a}} = \tapply{V}{a}{\tapply{U}{a}{x{\p a}}}} \)
        \item \( \sequent{x:2}{a,b}{
                    \tapply{U⊗V}{a,b}{x{\p{a,b}}}
                    = \tapply{U}{a}{\tapply{V}{b}{x{\p{a,b}}}}} \)
        \item \( \sequent{x:0,y:0,u:0,v:0}{a,b}{
                    \tmeasure{a}{\tmeasure{b}{u}{v}}{\tmeasure{b}{x}{y}}\\
                    \text{\hspace{7em}} = \tmeasure{b}{\tmeasure{a}{u}{x}}{\tmeasure{a}{v}{y}}} \)
    \end{enumerate}
    Enakost bomo izpeljali zgolj za prve tri aksiome, saj so aksiomi (\ref{ax:F})–(\ref{ax:J}) enostavne posledice definicij uporabe matrik.
    Omenimo le pri aksiomu (\ref{ax:I}), da \(a,b\) v zapisu interpretiramo kot kvantni vektor, kjer \(a\) naslavlja prvi kubit, \(b\) pa drugega. Intuitivno si lahko predstavljamo \(a,b\) kot \(a⊗b\), ampak je vredno omeniti, da sta tu \(a\) in \(b\) lahko prepletena, torej vektorja, ki ga \(a,b\) predstavlja ne moremo nujno zapisati kot tenzorski produkt kubitov.

    Interpretirajmo aksiom (\ref{ax:A}). Naj bosta \(A₁,A₂ ∈ \M[1] = ℂ\).
    \begin{align*}
        &\hspace{-3em}\sem{\tapply{X}{a}{\tmeasure{a}{x}{y}}}(A₁,A₂)
         = X\pmat{A₁&0\\0&A₂}X^*\\
        &= \pmat{A₂&0\\0&A₁}
         = \sem{\tmeasure{a}{y}{x}}(A₁,A₂)
    \end{align*}

    Interpretirajmo še aksiom (\ref{ax:B}). Naj bosta \(A₁,A₂ ∈ \M[2]\).
    \begin{align*}
        &\hspace{-3em}\sem{\tapplyd{U, V}{a,b}{\tmeasure{a}{x(b)}{y(b)}}}(A₁,A₂)
         = \pmat{U&0\\0&V}\pmat{A₁&0\\0&A₂}\pmat{U^*&0\\0&V^*}\\
        &= \pmat{UA₁U^*&0\\0&VA₂V^*}
         = \sem{\tmeasure{a}{\tapply{U}{b}{x(b)}}{\tapply{V}{b}{y(b)}}}(A₁,A₂)
    \end{align*}

    Podrobno si še oglejmo interpretacijo aksioma (\ref{ax:F}). Naj bo \(A ∈ \M[4]\).
    \begin{align*}
        &\hspace{-3em}\sem{\tapply{swap}{a,b}{x{\p{a,b}}}}(A)
         = \mathrm{Swap}A\mathrm{Swap}^*\\
        &= \pmat{1&0&0&0\\0&0&1&0\\0&1&0&0\\0&0&0&1}\pmat{a₁₁&a₁₂&a₁₃&a₁₄\\a₂₁&a₂₂&a₂₃&a₂₄\\a₃₁&a₃₂&a₃₃&a₃₄\\a₄₁&a₄₂&a₄₃&a₄₄}\pmat{1&0&0&0\\0&0&1&0\\0&1&0&0\\0&0&0&1}\\
        &= \pmat{a₁₁&a₁₃&a₁₂&a₁₄\\a₃₁&a₃₃&a₃₂&a₃₄\\a₂₁&a₂₃&a₂₂&a₂₄\\a₄₁&a₄₃&a₄₂&a₄₄}
         = \sem{x{\p{b,a}}}(A)
    \end{align*}
    
    Ostale aksiome lahko preverimo podobno.
    %TODO: then do it?
\end{proof}

\begin{theorem}[Polnost za meritev]\label{th:partial}
    %TODO: prava polnost? univerzalnost/polnost?
    Kompleksna števila tvorijo poln model:
    \begin{enumerate}
        \item Za vsak \(*\)-homomorfizem \(f : \semmap{p}{m₁,…,mₖ}\) obstaja izraz v algebrajski teoriji, ki ne vsebuje \(\op{new}\), tako da je \(t : \arity{p}{m₁,…,mₖ}\) in \(\sem{t} = f\).
        \item Če \(\absseq{t, u}\) ne vsebujeta \(\op{new}\) in \(\sem{t} = \sem{u}\) lahko izpeljemo \(\absseq{t = u}\).
    \end{enumerate}
\end{theorem}

% \begin{proposition}
%     Neničelni \(*\)-homomorfizmi \(\M[k] → \M[n]\) obstajajo le, če je \(n ≥ k\).
% \end{proposition}

\begin{proposition}
    Naj bo \(n ≥ k\) in \(f : \M[k] → \M[n]\) \(*\)-homomorfizem, ki ne (nujno) ohranja enote. Tedaj obstaja unitarna preslikava \(U ∈ \M[n]\), tako da je \(f\) oblike \(A ↦ UD{(A,…,A,0)}U^*\), kjer se \(A\) na diagonali pojavi \(m\)-krat, \(0\) je \(r×r\) ničelna matrika, in velja \(n = m⋅k + r\). Številu \(m\) pravimo kratnost \(*\)-homomorfizma.
    Če \(f\) ohranja enoto je \(r = 0\) in \(n = m⋅k\).
\end{proposition}

Označimo \(\cat{C} ≔ \semmap{p}{m₁,…,mₖ}\).

%TODO: cite P. A. Fillmore
\begin{definition}
    % Za preslikavo \(f : A → B\), kjer je \(A = \M[k₁]⊕⋯⊕\M[kᵣ]\) in \(B = \M[n₁]⊕⋯⊕\M[nₛ]\) je Brattelijev diagram multigraf z dvema vrsticama vozlišč označenih s \(kᵢ\) in \(nⱼ\), skupaj z \(mᵢⱼ\) povezavami med \(kᵢ\) in \(nⱼ\), kjer je \(mᵢⱼ\) kratnost preslikave \(πⱼ∘f∘ιᵢ\).
    Za \(m₁,…,mₖ,p ∈ ℕ₊\) so elementi množice Brattelijevih diagramov \(\cat{B} ≔ \brat{2ᵖ}{2^{m₁},…,2^{mₖ}}\) \(k\)-terice naravnih števil \(\p{s₁,…,sₖ}\), tako da je \(∑ᵢsᵢ2^{mᵢ} = 2ᵖ\).
    Definiramo funkcijo \(μ : \cat{B} → \cat{C}\) s predpisom
    \[μ{\p{s₁,…,sₖ}}{\p{A₁,…,Aₖ}} = D{\p{A₁,…,A₁,A₂,…,Aₖ}},\] kjer se \(Aᵢ\) na diagonali pojavi \(sᵢ\)-krat. 
\end{definition}

\begin{lemma}
    Obstaja \(ρ : \cat{C} → \cat{B}\), da je \(ρ∘μ = \id\). Še več, \(ρ{\p f}\) in \(ρ{\p g}\) sta enaka natanko tedaj, ko obstaja \(2ᵖ×2ᵖ\) unitarna matrika \(U\), tako da je \(f = U^*(g(-))U\).
\end{lemma}

\begin{proof}
    Naj bosta \(f,g : \semmap{p}{m₁,…,mₖ}\) \(*\)-homomorfizma.

    Definirajmo \(fᵢ ≔ f∘ιᵢ, gᵢ ≔ g∘ιᵢ : \M[2^{mᵢ}] → \M[2ᵖ]\), kjer je \(ιᵢ(A) = (0,…,A,…,0)\) (z \(A\)-jem na \(i\)-tem mestu).

    Preslikavo \(ρ\) definiramo tako, da \(f\) slika v \(k\)-terico kratnosti preslikav \(fᵢ\). Označimo \(ρ(f) = \p{t₁,…,tₖ}\).

    Zaradi tranzitivnosti lahko za \(g\) vzamemo kar \(μ(ρ(g)) = μ(s₁,…,sₖ)\).

    \((⇐)\)
    Naj bo \(f = Ug{(-)}U^*\).
    Enakost komponiramo z \(ιᵢ\) in dobimo enakosti \(fᵢ = Ugᵢ{(-)}U^*\).
    Po zgornji trditvi za vsak \(A\) velja \(fᵢ{(A)} = Vᵢ(D(A,…,A))Vᵢ^* ≕ VᵢD_{tᵢ}Vᵢ^*\), \(gᵢ{(A)}\) je pa enak \(D(0,A,…,A,0) ≕ D_{sᵢ}\), kjer se pri vsakem \(D\)-ju \(A\) na diagonali pojavi \(tᵢ\) in \(sᵢ\)-krat.
    Vstavimo te dve enačbi v predpostavko in nesemo unitarne matrike na eno stran, da dobimo \(D_{tᵢ} = (VᵢU)D_{sᵢ}(VᵢU)^*\).

    Naj bo sedaj \(A\) neka matrika ranga \(1\).
    Ker unitarne matrike ne vplivajo na rang, je \(tᵢ = \rang{D_{tᵢ}} = \rang{D_{sᵢ}} = sᵢ\).
    Ker je bil \(i\) poljuben, sta torej Brattelijeva diagrama, ki pripadata \(f\) in \(g\), enaka.

    \((⇒)\)
    Naj bo tudi \(ρ(f) = (s₁,…,sₖ)\).
    % TODO: js ne znam q.q
\end{proof}

\begin{proof}[Dokaz izreka \ref{th:partial}.]
    TODO
\end{proof}

\subsection{Polnost v splošnem}

\begin{definition}
    Element \(x\) \(C^*\)-algebre je pozitiven, če obstaja kak element \(y\), da je \(x = y^*y\).
\end{definition}

\begin{definition}
    Preslikava \(f\) je popolnoma pozitivna, če za vsak \(k ∈ ℕ₊\) preslikava \(Mₖ{\p f}\) ohranja pozitivnost elementov.
\end{definition}

\begin{proposition}
    Za \(f : X → Y\), kjer množenje v enem od \(X\) in \(Y\) komutira, so naslednje trditve ekvivalentne:
    \begin{enumerate}
        \item \(f\) ohranja pozitivnost elementov,
        \item za vsak \(k ∈ ℕ₊\) preslikava \(Mₖ{\p f}\) ohranja pozitivnost elementov,
        \item \(f\) je popolnoma pozitivna.
    \end{enumerate}
\end{proposition}

\begin{proof}
    Trditvi \((2)\) in \((3)\) sta ekvivalentni po definiciji in očitno \((2) ⇒ (1)\).
    Dokazati moramo torej zgolj \((1) ⇒ (2)\).
    TODO
\end{proof}

\begin{definition}
    Preslikava \(f\) je eniška, če slika enoto v enoto.
\end{definition}

\begin{proposition}
    \(C^*\)-algebre skupaj s popolnoma pozitivnimi eniškimi preslikavami tvorijo kategorijo \(\cstarcpucat\) (angl. \foreignlanguage{english}{Completely Positive Unital maps}).
\end{proposition}
\begin{proof}
    TODO
\end{proof}

\begin{definition}
    Dodeljevanje novih kubitov interpretiramo s preslikavami oblike
    \(\op{new}{\p X} : \opmap{0}{1}\) s predpisom \[\snew{\mat{α₁₁ & α₁₂ \\ α₂₁ & α₂₂}}{\p X} = α₁₁.\]

    Dodelitev \(j\)-tega kubita izvajamo z \(\op{new}ⱼ ≔ Mⱼ{\p{\op{new}{\p X}}}\).
\end{definition}
\begin{remark}
    Za \(X\) spet implicitno izberemo tak \(\M[k]\), da bo interpretacija prave dimenzije.
\end{remark}

%NOTE: maybe different notation operations and the interpretation morphisms
\begin{proposition}
    Preslikave \(\op{new}\) niso \(*\)-homomorfizmi.
\end{proposition}

\begin{proof}
    Denimo, da je \(\op{new}₁\) \(*\)-homomorfizem. Potem je 
    \[0 = \snew₁{\mat{0&1\\0&0}}\snew₁{\mat{0&0\\1&0}}
        = \snew₁{\bmat{0&1\\0&0}⋅\bmat{0&0\\1&0}}
        = \snew₁{\mat{1&0\\0&0}}
        = 1 \contradiction\qedhere
    \]
\end{proof}

\begin{proposition}
    Preslikave \(\op{new}\) so popolnoma pozitivne in eniške.
\end{proposition}

\begin{proof}
    Preverimo obe lastnosti za \(\op{new}{\p ℂ}\):
    \begin{itemize}
        \item \(\snew₁{\mat{1&0\\0&1}} = 1\),
        \item Naj bo \(x\) pozitiven element. Potem je \(x = y^*y\), za nek \(y ∈ \M[2]\).
        Če zapišemo \(y = \pmat{a&b\\c&d}\) je potem \(\snew₁{x} = a\bar a + c\bar c\).
        Število \(a\bar a + c\bar c\) je realno in nenegativno, torej lahko vzamemo \(y = \sqrt{a\bar a + c\bar c}\).\qedhere
    \end{itemize}
\end{proof}

\begin{proposition}
    Kompleksna števila \(ℂ ∈ \cstarcpucat\) tvorijo model kvantnega računalništva.
\end{proposition}

\begin{proof}
    Ker so \(*\)-homomorfizmi tudi popolnoma pozitivni in eniški moramo pokazati zgolj enakost interpretacij preostalih aksiomov ((\ref{ax:D}), (\ref{ax:E}), (\ref{ax:K}), (\ref{ax:L})).
    \begin{enumerate}[\((A)\)]
        \addtocounter{enumi}{3}
        \item \( \sequent{x:0,y:0}{-}{\tnew{a}{\tmeasure{a}{x}{y}} = x} \).
        \item \( \sequent{x:2}{b}{
                    \tnew{a}{\tapplyd{U,V}{a,b}{x{\p{a,b}}}} = \tapply{U}{b}{\tnew{a}{x{\p{a,b}}}}} \).
        \addtocounter{enumi}{5}
        \item \( \sequent{x:2}{-}{\tnew{a}{\tnew{b}{x{\p{a,b}}}} = \tnew{b}{\tnew{a}{x{\p{a,b}}}}} \)
        \item \( \sequent{x:1,y:1}{b}{\tnew{a}{\tmeasure{b}{x{\p a}}{y{\p a}}}\\
            \text{\hspace{7em}} = \tmeasure{b}{\tnew{a}{x{\p a}}}{\tnew{a}{y{\p a}}}} \)
    \end{enumerate}

    Preverimo kar vse štiri aksiome po vrsti.
    Naj bosta \(A₁,A₂ ∈ \M[1]\).
    \begin{align*}
        \sem{\tnew{a}{\tmeasure{a}{x}{y}}}(A₁,A₂)
         = \snew₁{\mat{A₁&0\\0&A₂}} = A₁ = \sem{x}(A₁,A₂).
    \end{align*}

    Naj bo \(A ∈ \M[4]\).
    \begin{align*}
        &\hspace{-3em}\sem{\tnew{a}{\tapplyd{U,V}{a,b}{x{\p{a,b}}}}}(A)
         = \snew₁{\sem{\tapplyd{U,V}{a,b}{x{\p{a,b}}}}(A)}\\
        &= \snew₁{\bmat{U&0\\0&V}\bmat{A₁₁&A₁₂\\A₂₁&A₂₂}\bmat{U^*&0\\0&V^*}}
         = \snew₁{\mat{UA₁₁U^*&UA₁₂V^*\\VA₂₁U^*&VA₂₂V^*}}\\
        &= UA₁₁U^*
         = U\p{\snew₁{A}}U^*
         = \sem{\tapply{U}{b}{\tnew{a}{x{\p{a,b}}}}}(A).
    \end{align*}
    \begin{align*}
        &\hspace{-3em}\sem{\tnew{a}{\tnew{b}{x{\p{a,b}}}}}(A)
         = \snew₁{\snew₂{A}}
         = a₁₁\\
        &= \snew₂{\snew₁{\p A}}
         = \sem{\tnew{b}{\tnew{a}{x{\p{a,b}}}}}(A).
    \end{align*}

    Naj bosta \(A,B ∈ \M[2]\).
    \begin{align*}
        &\hspace{-3em}\sem{\tnew{a}{\tmeasure{b}{x{\p a}}{y{\p a}}}}(A,B)
         = \snew₁{\smeasure₂{A}{B}}\\
        &= \pmat{a₁₁&0\\0&b₁₁}
         = \smeasure₁{\snew₁{A}}{\snew₁{B}}\\
        &= \sem{\tmeasure{b}{\tnew{a}{x{\p a}}}{\tnew{a}{y{\p a}}}}(A,B).\qedhere
    \end{align*}
\end{proof}

\begin{theorem}[Polnost v splošnem]
    Kompleksna števila tvorijo poln model:
    \begin{enumerate}
        \item Za vsako popolnoma pozitivno eniško preslikavo \(f : \semmap{p}{m₁,…,mₖ}\) obstaja izraz v algebrajski teoriji, tako da je \(t : \arity{p}{m₁,…,mₖ}\) in \(\sem{t} = f\).
        \item Če \(\absseq{t, u}\) in \(\sem{t} = \sem{u}\) lahko izpeljemo \(\absseq{t = u}\).
    \end{enumerate}
\end{theorem}

\subsection{Dokaz polnosti}
Naštejmo najprej nekaj pomožnih izrekov.

\begin{theorem}[Stinespringov izrek o dilaciji]
    Naj bo \(f : \mc A → \M[p]\) popolnoma pozitivna in eniška. Tedaj obstaja \(q ≥ p\) in \(*\)-homomorfizem \(g : \mc A → \M[q]\), tako da je \(f(A) = g(A)|ₚ\).
    \[\begin{tikzcd}
        A \\
        {\M[q]} & {\M[p]}
        \arrow[     from=2-1, to=2-2]
        \arrow["g", from=1-1, to=2-1]
        \arrow["f", from=1-1, to=2-2]
    \end{tikzcd}\]
\end{theorem}

\begin{theorem}[o minimalnosti dilacije]
    Lahko izberemo minimalno dilacijo: če je \(r ≥ p\) in \( h : \mc A → \M[p] \) \(*\)-homomorfizem tak, da je \( h(-)|ₚ = f(-) \) je \(r ≥ q\) in \(g(-) = Uh(-)U^*|_q\) za neko \(r×r\) unitarno matriko.
    % https://q.uiver.app/?q=WzAsNSxbMywwLCJBIl0sWzMsMSwiXFxNW3FdIl0sWzQsMSwiXFxNW3BdIl0sWzIsMSwiXFxNW3JdIl0sWzAsMSwiXFxNW3JdIl0sWzEsMl0sWzAsMSwiZyJdLFswLDIsImYiXSxbMywxXSxbNCwzLCJVKC0pVSoiLDFdLFswLDQsImgiLDJdLFs0LDIsIiIsMix7ImN1cnZlIjozfV1d
    \[\begin{tikzcd}
        &&& A \\
        {\M[r]} && {\M[r]} & {\M[q]} & {\M[p]}
        \arrow[                          from=2-4, to=2-5]
        \arrow["g",                      from=1-4, to=2-4]
        \arrow["f",                      from=1-4, to=2-5]
        \arrow[                          from=2-3, to=2-4]
        \arrow["{U(-)U^*}"{description}, from=2-1, to=2-3]
        \arrow["h"',                     from=1-4, to=2-1]
        \arrow[curve={height=20pt},      from=2-1, to=2-5]
    \end{tikzcd}\]
\end{theorem}

\begin{proof}[Dokaz izreka o polnosti.]
    Naj bo \(f : \semmap{p}{m₁,…,mₖ}\) kot v izreku. Potem lahko uporabimo Stinespringov izrek o dilaciji, skupaj z minimalnostjo, da \(f\) razcepimo na \(g : A → \M[q]\), za nek \(q ≥ 2ᵖ\), kjer je \(A = \M[2^{m₁}]⊗⋯⊗\M[2^{mₖ}]\).
    Če je \(q\) potenca \(2\), je izrek praktično dokazan; \(g\) lahko definiramo po izreku \ref{th:partial}, skrčitev pa z zaporednimi \(\op{new}\) in premešavanjem koordinat.
    Drugi del sledi iz minimalnosti dilacije. %TODO: source?
    Vendar v splošnem \(q\) ni potenca \(2\). Kljub temu, pa lahko tudi \(g\) ustrezno faktoriziramo:
    % https://q.uiver.app/?q=WzAsNSxbMCwwLCJBIl0sWzMsMCwiMl57beG1on1cXGNkb3QgXFxNW3Fd4oqVKDJecS1xKVxcY2RvdFxcTVsyXntt4bWifV0iXSxbNCwwLCJcXE1bMl57beG1oitxfV0iXSxbNCwxLCJcXE1bcV0iXSxbNCwyLCJcXE1bMl5wXSJdLFswLDQsImYiLDJdLFswLDMsImciLDJdLFswLDEsIigyXntt4bWifVxcY2RvdCBnLCgyXmwtcSlcXGNkb3Qgz4DhtaIpIl0sWzEsMl0sWzIsM10sWzMsNF0sWzEsMywiz4DigoEiXV0=
    \[\begin{tikzcd}
        A &&& {2^{mᵢ}\cdot \M[q]⊕(2^q-q)\cdot\M[2^{mᵢ}]} & {\M[2^{mᵢ+q}]} \\
        &&&& {\M[q]} \\
        &&&& {\M[2^p]}
        \arrow["f"',                                from=1-1, to=3-5]
        \arrow["g"',                                from=1-1, to=2-5]
        \arrow["{(2^{mᵢ}\cdot g,(2^q-q)\cdot πᵢ)}", from=1-1, to=1-4]
        \arrow["h",                                 from=1-4, to=1-5]
        \arrow[                                     from=1-5, to=2-5]
        \arrow[                                     from=2-5, to=3-5]
        \arrow["{π₁}",                              from=1-4, to=2-5]
    \end{tikzcd}\]
    Navpične preslikave so zožitve, vodoravne pa \(*\)-homomorfizmi, torej lahko kot prej definiramo izraz \(t\), da je \(\sem{t} = f\).
    Ostane nam še drugi del izreka, naj bosta \(t\) in \(u\) taka, da je \(\sem{t} = \sem{u}\).
    Po iz aksiomov o komutativnosti lahko zapišemo \(t\) kot \(\tnew{a₁,…,aₗ}{t'}\) (in podobno za \(u\)). Iz aksioma \ref{ax:D} sledi \(\tnew{a}{\tdiscard{a}{x}} = x\), torej je BŠS število \(\op{new}\) na začetku \(t\) in \(u\) enako.
    Po izreku \ref{th:partial} imamo \(*\)-homomorfizma \(\sem{t'}, \sem{u'}: A → \M[2ˡ]\), tako da velja \(\sem{t} = A \xrightarrow{\sem{t'}} \M[2ˡ] → \M[2ᵖ]\) in \(\sem{u} = A \xrightarrow{\sem{u'}} \M[2ˡ] → \M[2ᵖ]\).
    Po Stinespringovem izreku in minimalnosti spet sledi, da lahko \(\sem{t} = \sem{u}\) faktoriziramo skozi nek \(\M[q]\). Po minimalnosti (kjer za \(h\) vzamemo \(\sem{t'}\) in \(\sem{u'}\) ter \(r = 2ˡ\)) tudi obstajata \(2ˡ×2ˡ\) unitarni matriki \(U\) in \(V\), da spodnji diagram komutira.
    % https://q.uiver.app/?q=WzAsNyxbMCwyLCJBIl0sWzMsMCwiXFxNWzLLoV0iXSxbNCwxLCJcXE1bMsuhXSJdLFs1LDIsIlxcTVsyXnFdIl0sWzMsNCwiXFxNWzLLoV0iXSxbNCwzLCJcXE1bMsuhXSJdLFs3LDIsIlxcTVsy4bWWXSJdLFswLDEsIlxcc2Vte3QnfSJdLFsxLDIsIlUoLSlVXioiLDJdLFsyLDNdLFswLDQsIlxcc2Vte3UnfSJdLFs0LDUsIlYoLSlWXioiXSxbNSwzXSxbNCw2LCIiLDEseyJjdXJ2ZSI6M31dLFsxLDYsIiIsMSx7ImN1cnZlIjotM31dLFszLDZdXQ==
    \[\begin{tikzcd}
        &&& {\M[2ˡ]} \\
        &&&& {\M[2ˡ]} \\
        A &&&&& {\M[2^q]} && {\M[2ᵖ]} \\
        &&&& {\M[2ˡ]} \\
        &&& {\M[2ˡ]}
        \arrow["{\sem{t'}}",         from=3-1, to=1-4]
        \arrow["{U(-)U^*}"',         from=1-4, to=2-5]
        \arrow[                      from=2-5, to=3-6]
        \arrow["{\sem{u'}}",         from=3-1, to=5-4]
        \arrow["{V(-)V^*}",          from=5-4, to=4-5]
        \arrow[                      from=4-5, to=3-6]
        \arrow[curve={height=18pt},  from=5-4, to=3-8]
        \arrow[curve={height=-18pt}, from=1-4, to=3-8]
        \arrow[                      from=3-6, to=3-8]
    \end{tikzcd}\]
    Kompozituma preslikav na notranjem diamantu sta \(*\)-homomorfizma.
    Ker desna trikotnika komutirata, matriki \(U\) in \(V\) ne spreminjata prvih \(p\) kubitov
    in lahko po spodnji lemi BŠS vzamemo \(U = V = I\).

    \begin{lemma}\label{lemma:fix}
        Naj bo \(m < n\) in \(U\) vrata reda \(n\), ki fiksirajo prvih \(m\) kubitov.
        Tedaj lahko izpeljemo
        \[ \sequent{x:n}{a₁,…,aₘ}{\tnew{a_{m+1},…,aₙ}{\tapply{U}{a}{x(a)}}
                                  = \tnew{a_{m+1},…,aₙ}{x(a)}}.\]
    \end{lemma}
    
    \begin{proof}[Dokaz leme]
        Ker je \(U = D{\p{I, U'}}\) za neka vrata \(U'\) reda \(n-m\), je po aksiomu \ref{ax:E} leva stran enaka \(\tapply{I}{a₁,…,aₘ}{\tnew{a_{m+1},…,aₙ}{x(a)}}\), kar je pa enako desni strani po aksiomu \ref{ax:G}.
    \end{proof}

    Zgornji diagram lahko torej poenostavimo na
    % https://q.uiver.app/?q=WzAsNCxbMCwxLCJBIl0sWzEsMCwiXFxNWzLLoV0iXSxbMiwxLCJcXE1bMl5xXSJdLFsxLDIsIlxcTVsyy6FdIl0sWzAsMSwiXFxzZW17dCd9Il0sWzAsMywiXFxzZW17dSd9IiwyXSxbMywyXSxbMSwyXV0=
    \[\begin{tikzcd}
        & {\M[2ˡ]} \\
        A && {\M[2^q]} \\
        & {\M[2ˡ]}
        \arrow["{\sem{t'}}",  from=2-1, to=1-2]
        \arrow["{\sem{u'}}"', from=2-1, to=3-2]
        \arrow[               from=3-2, to=2-3]
        \arrow[               from=1-2, to=2-3]
    \end{tikzcd}\]
    in uporabimo sledečo lemo:

    \begin{lemma}
        Če sta \(f\) in \(g\) taka \(*\)-homomorfizma, da spodnji diagram komutira
        \[\begin{tikzcd}
            A \\
            {\M[p+q]} & {\M[p]}
            \arrow[      from=2-1, to=2-2]
            \arrow["f"', from=1-1, to=2-1]
            \arrow["g",  from=1-1, to=2-2]
        \end{tikzcd}\]
        kjer je vodoravna preslikava zožitev, lahko preslikavo \(f\) faktoriziramo skozi bločno-diagonalno preslikavo \(\M[p]⊕\M[q] → \M[p+q]\) (meritev).
    \end{lemma}

    Iz te leme dobimo preslikave \(f\), \(f'\), \(g\), \(h\) in lahko z njimi razširimo naš diagram.
    % https://q.uiver.app/?q=WzAsNixbMCwxLCJBIl0sWzMsMCwiXFxNWzLLoV0iXSxbNCwxLCJcXE1bMl5xXSJdLFszLDIsIlxcTVsyy6FdIl0sWzEsMCwiXFxNW3Fd4oqVXFxNWzLLoS1xXSJdLFsxLDIsIlxcTVtxXeKKlVxcTVsyy6EtcV0iXSxbMCwxLCJcXHNlbXt0J30iLDIseyJsYWJlbF9wb3NpdGlvbiI6ODB9XSxbMCwzLCJcXHNlbXt1J30iLDAseyJsYWJlbF9wb3NpdGlvbiI6ODB9XSxbMywyXSxbMSwyXSxbMCw1LCIoZicsIGgpIiwyXSxbMCw0LCIoZiwgZykiXSxbNSwzXSxbNCwxXV0=
    \[\begin{tikzcd}
        & {\M[q]⊕\M[2ˡ-q]} && {\M[2ˡ]} \\
        A &&&& {\M[2^q]} \\
        & {\M[q]⊕\M[2ˡ-q]} && {\M[2ˡ]}
        \arrow["{\sem{t'}}"'{pos=0.6}, from=2-1, to=1-4]
        \arrow["{\sem{u'}}"{pos=0.6},  from=2-1, to=3-4]
        \arrow[                        from=3-4, to=2-5]
        \arrow[                        from=1-4, to=2-5]
        \arrow["{(f', h)}"',           from=2-1, to=3-2]
        \arrow["{(f, g)}",             from=2-1, to=1-2]
        \arrow[                        from=3-2, to=3-4]
        \arrow[                        from=1-2, to=1-4]
    \end{tikzcd}\]
    Ker diagram komutira, takoj vidimo, da je \(f = f'\).

    Vemo, da je \(t = \tnew{a}{\tnew{b}{\tmeasure{b}{t'}{u'}}}\) in po lemi \ref{lemma:fix}
    je to enako tudi \(\tnew{a}{\tnew{b}{\tapply{U}{a,b}{\tmeasure{b}{t'}{u'}}}}\),
    kjer je \(U\) unitarna matrika, ki zamenja pojavitvi \((2ˡ-q)\) v \(\M[q + (2ˡ-q) + q + (2ˡ-q)] = \M[2ˡ]⊗\M[2]\). Matrika je res prave dimenzije (saj je \(a\) vektor \(l\)-tih kubitov, ki mu priključimo še en kubit \(b\)), in fiksira prvih \(q > 2ᵖ\) vrstic, torej prvih \(p\) kubitov.

    Sledi, da je \(t = u\) čim je \(\tapply{U}{a,b}{\tmeasure{b}{t'}{u'}} = \tmeasure{b}{u'}{t'}\).
    Po izreku \ref{th:partial} lahko enakost izpeljemo natanko tedaj, ko sta pripadajoča \(*\)-homomorfizma enaka. Če ju izračunamo res vidimo, da sta enaka:
    \begin{align*}
        &\hspace{-3em}\sem{\tapply{U}{a,b}{\tmeasure{b}{t'}{u'}}}(x)
         = U\pmat{\sem{t'}(x)&0\\0&\sem{u'}(x)}U^*\\
        &= U\pmat{f(x)&0&0&0\\0&g(x)&0&0\\0&0&f(x)&0\\0&0&0&h(x)}U^*
         = \pmat{f(x)&0&0&0\\0&h(x)&0&0\\0&0&f(x)&0\\0&0&0&g(x)}\\
        &= \pmat{\sem{u'}(x)&0\\0&\sem{t'}(x)}
         = \sem{\tmeasure{b}{u'}{t'}},
    \end{align*}
    torej je dokaz končan.
\end{proof}
